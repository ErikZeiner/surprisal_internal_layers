/home/tu/tu_tu/tu_zxolr37/.conda/envs/surprisal/lib/python3.11/site-packages/torch/cuda/__init__.py:829: UserWarning: Can't initialize NVML
  warnings.warn("Can't initialize NVML")
/home/tu/tu_tu/tu_zxolr37/.conda/envs/surprisal/lib/python3.11/site-packages/torch/cuda/__init__.py:829: UserWarning: Can't initialize NVML
  warnings.warn("Can't initialize NVML")
The installed version of bitsandbytes was compiled without GPU support. 8-bit optimizers, 8-bit multiplication, and GPU quantization are unavailable.
The installed version of bitsandbytes was compiled without GPU support. 8-bit optimizers, 8-bit multiplication, and GPU quantization are unavailable.
Traceback (most recent call last):
  File "/gpfs/bwfor/home/tu/tu_tu/tu_zxolr37/surprisal_internal_layers/src/EZ_run_gpt2_transformer_lens.py", line 15, in <module>
    from transformer_lens import HookedTransformer
  File "/home/tu/tu_tu/tu_zxolr37/.conda/envs/surprisal/lib/python3.11/site-packages/transformer_lens/__init__.py", line 8, in <module>
    from . import components
  File "/home/tu/tu_tu/tu_zxolr37/.conda/envs/surprisal/lib/python3.11/site-packages/transformer_lens/components/__init__.py", line 9, in <module>
    from .abstract_attention import AbstractAttention
  File "/home/tu/tu_tu/tu_zxolr37/.conda/envs/surprisal/lib/python3.11/site-packages/transformer_lens/components/abstract_attention.py", line 22, in <module>
    import bitsandbytes as bnb
  File "/home/tu/tu_tu/tu_zxolr37/.conda/envs/surprisal/lib/python3.11/site-packages/bitsandbytes/__init__.py", line 15, in <module>
    from .nn import modules
  File "/home/tu/tu_tu/tu_zxolr37/.conda/envs/surprisal/lib/python3.11/site-packages/bitsandbytes/nn/__init__.py", line 21, in <module>
    from .triton_based_modules import (
  File "/home/tu/tu_tu/tu_zxolr37/.conda/envs/surprisal/lib/python3.11/site-packages/bitsandbytes/nn/triton_based_modules.py", line 7, in <module>
    from bitsandbytes.triton.int8_matmul_mixed_dequantize import (
  File "/home/tu/tu_tu/tu_zxolr37/.conda/envs/surprisal/lib/python3.11/site-packages/bitsandbytes/triton/int8_matmul_mixed_dequantize.py", line 12, in <module>
    from triton.ops.matmul_perf_model import early_config_prune, estimate_matmul_time
ModuleNotFoundError: No module named 'triton.ops'
gpt2
1
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:07<01:41,  7.26s/it] 13%|█▎        | 2/15 [00:11<01:09,  5.32s/it] 20%|██        | 3/15 [00:14<00:51,  4.28s/it] 27%|██▋       | 4/15 [00:17<00:43,  3.94s/it] 33%|███▎      | 5/15 [00:21<00:37,  3.79s/it] 40%|████      | 6/15 [00:26<00:38,  4.25s/it] 47%|████▋     | 7/15 [00:31<00:36,  4.57s/it] 53%|█████▎    | 8/15 [00:33<00:26,  3.81s/it] 60%|██████    | 9/15 [00:36<00:20,  3.34s/it] 67%|██████▋   | 10/15 [00:37<00:14,  2.90s/it] 73%|███████▎  | 11/15 [00:39<00:10,  2.52s/it] 80%|████████  | 12/15 [00:41<00:06,  2.25s/it] 87%|████████▋ | 13/15 [00:45<00:05,  2.86s/it] 93%|█████████▎| 14/15 [00:48<00:03,  3.03s/it]100%|██████████| 15/15 [00:49<00:00,  2.37s/it]100%|██████████| 15/15 [00:49<00:00,  3.32s/it]
2
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:05<00:48,  5.42s/it] 20%|██        | 2/10 [00:09<00:35,  4.41s/it] 30%|███       | 3/10 [00:12<00:28,  4.06s/it] 40%|████      | 4/10 [00:16<00:23,  3.94s/it] 50%|█████     | 5/10 [00:22<00:23,  4.62s/it] 60%|██████    | 6/10 [00:24<00:15,  3.88s/it] 70%|███████   | 7/10 [00:29<00:12,  4.21s/it] 80%|████████  | 8/10 [00:37<00:10,  5.22s/it] 90%|█████████ | 9/10 [00:40<00:04,  4.69s/it]100%|██████████| 10/10 [00:42<00:00,  3.85s/it]100%|██████████| 10/10 [00:42<00:00,  4.26s/it]
3
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:03<00:50,  3.87s/it] 14%|█▍        | 2/14 [00:07<00:42,  3.56s/it] 21%|██▏       | 3/14 [00:09<00:33,  3.03s/it] 29%|██▊       | 4/14 [00:13<00:33,  3.38s/it] 36%|███▌      | 5/14 [00:16<00:28,  3.14s/it] 43%|████▎     | 6/14 [00:18<00:23,  2.93s/it] 50%|█████     | 7/14 [00:21<00:19,  2.83s/it] 57%|█████▋    | 8/14 [00:24<00:18,  3.02s/it] 64%|██████▍   | 9/14 [00:27<00:14,  2.86s/it] 71%|███████▏  | 10/14 [00:30<00:11,  2.83s/it] 79%|███████▊  | 11/14 [00:33<00:09,  3.14s/it] 86%|████████▌ | 12/14 [00:35<00:05,  2.74s/it] 93%|█████████▎| 13/14 [00:39<00:03,  3.01s/it]100%|██████████| 14/14 [00:42<00:00,  2.93s/it]100%|██████████| 14/14 [00:42<00:00,  3.01s/it]
4
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:03<00:43,  3.35s/it] 14%|█▍        | 2/14 [00:07<00:45,  3.82s/it] 21%|██▏       | 3/14 [00:10<00:37,  3.38s/it] 29%|██▊       | 4/14 [00:12<00:30,  3.06s/it] 36%|███▌      | 5/14 [00:15<00:25,  2.84s/it] 43%|████▎     | 6/14 [00:18<00:23,  2.98s/it] 50%|█████     | 7/14 [00:21<00:20,  2.91s/it] 57%|█████▋    | 8/14 [00:24<00:17,  2.96s/it] 64%|██████▍   | 9/14 [00:26<00:13,  2.71s/it] 71%|███████▏  | 10/14 [00:29<00:11,  2.77s/it] 79%|███████▊  | 11/14 [00:32<00:08,  2.83s/it] 86%|████████▌ | 12/14 [00:36<00:06,  3.24s/it] 93%|█████████▎| 13/14 [00:39<00:03,  3.17s/it]100%|██████████| 14/14 [00:41<00:00,  2.81s/it]100%|██████████| 14/14 [00:41<00:00,  2.98s/it]
5
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:02<00:30,  2.75s/it] 17%|█▋        | 2/12 [00:07<00:36,  3.69s/it] 25%|██▌       | 3/12 [00:11<00:36,  4.08s/it] 33%|███▎      | 4/12 [00:16<00:33,  4.21s/it] 42%|████▏     | 5/12 [00:19<00:28,  4.08s/it] 50%|█████     | 6/12 [00:24<00:25,  4.22s/it] 58%|█████▊    | 7/12 [00:27<00:18,  3.74s/it] 67%|██████▋   | 8/12 [00:30<00:14,  3.72s/it] 75%|███████▌  | 9/12 [00:32<00:09,  3.23s/it] 83%|████████▎ | 10/12 [00:35<00:06,  3.12s/it] 92%|█████████▏| 11/12 [00:38<00:02,  2.97s/it]100%|██████████| 12/12 [00:39<00:00,  2.30s/it]100%|██████████| 12/12 [00:39<00:00,  3.27s/it]
6
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:03<00:53,  3.59s/it] 12%|█▎        | 2/16 [00:06<00:46,  3.31s/it] 19%|█▉        | 3/16 [00:09<00:39,  3.07s/it] 25%|██▌       | 4/16 [00:13<00:42,  3.52s/it] 31%|███▏      | 5/16 [00:16<00:36,  3.28s/it] 38%|███▊      | 6/16 [00:19<00:30,  3.02s/it] 44%|████▍     | 7/16 [00:21<00:26,  2.95s/it] 50%|█████     | 8/16 [00:25<00:25,  3.24s/it] 56%|█████▋    | 9/16 [00:28<00:22,  3.17s/it] 62%|██████▎   | 10/16 [00:31<00:17,  2.90s/it] 69%|██████▉   | 11/16 [00:34<00:14,  2.98s/it] 75%|███████▌  | 12/16 [00:37<00:12,  3.08s/it] 81%|████████▏ | 13/16 [00:39<00:08,  2.80s/it] 88%|████████▊ | 14/16 [00:42<00:05,  2.71s/it] 94%|█████████▍| 15/16 [00:44<00:02,  2.60s/it]100%|██████████| 16/16 [00:45<00:00,  2.24s/it]100%|██████████| 16/16 [00:45<00:00,  2.87s/it]
7
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:01<00:16,  1.54s/it] 17%|█▋        | 2/12 [00:04<00:21,  2.12s/it] 25%|██▌       | 3/12 [00:06<00:21,  2.43s/it] 33%|███▎      | 4/12 [00:09<00:20,  2.54s/it] 42%|████▏     | 5/12 [00:13<00:20,  2.96s/it] 50%|█████     | 6/12 [00:16<00:17,  2.99s/it] 58%|█████▊    | 7/12 [00:19<00:14,  3.00s/it] 67%|██████▋   | 8/12 [00:22<00:12,  3.03s/it] 75%|███████▌  | 9/12 [00:25<00:09,  3.02s/it] 83%|████████▎ | 10/12 [00:28<00:05,  2.97s/it] 92%|█████████▏| 11/12 [00:30<00:02,  2.74s/it]100%|██████████| 12/12 [00:33<00:00,  2.78s/it]100%|██████████| 12/12 [00:33<00:00,  2.78s/it]
8
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:03<00:31,  3.88s/it] 22%|██▏       | 2/9 [00:08<00:28,  4.04s/it] 33%|███▎      | 3/9 [00:11<00:22,  3.73s/it] 44%|████▍     | 4/9 [00:17<00:24,  4.82s/it] 56%|█████▌    | 5/9 [00:21<00:17,  4.33s/it] 67%|██████▋   | 6/9 [00:25<00:12,  4.27s/it] 78%|███████▊  | 7/9 [00:30<00:08,  4.38s/it] 89%|████████▉ | 8/9 [00:36<00:05,  5.08s/it]100%|██████████| 9/9 [00:37<00:00,  3.80s/it]100%|██████████| 9/9 [00:37<00:00,  4.18s/it]
9
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:02<00:32,  2.95s/it] 17%|█▋        | 2/12 [00:08<00:44,  4.43s/it] 25%|██▌       | 3/12 [00:14<00:48,  5.41s/it] 33%|███▎      | 4/12 [00:17<00:33,  4.19s/it] 42%|████▏     | 5/12 [00:20<00:26,  3.72s/it] 50%|█████     | 6/12 [00:22<00:18,  3.14s/it] 58%|█████▊    | 7/12 [00:25<00:15,  3.03s/it] 67%|██████▋   | 8/12 [00:27<00:11,  2.77s/it] 75%|███████▌  | 9/12 [00:30<00:08,  2.95s/it] 83%|████████▎ | 10/12 [00:34<00:06,  3.27s/it] 92%|█████████▏| 11/12 [00:37<00:03,  3.04s/it]100%|██████████| 12/12 [00:40<00:00,  3.29s/it]100%|██████████| 12/12 [00:40<00:00,  3.41s/it]
10
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:04<00:42,  4.28s/it] 18%|█▊        | 2/11 [00:08<00:37,  4.20s/it] 27%|██▋       | 3/11 [00:11<00:27,  3.46s/it] 36%|███▋      | 4/11 [00:13<00:21,  3.04s/it] 45%|████▌     | 5/11 [00:18<00:21,  3.65s/it] 55%|█████▍    | 6/11 [00:20<00:16,  3.29s/it] 64%|██████▎   | 7/11 [00:23<00:12,  3.20s/it] 73%|███████▎  | 8/11 [00:26<00:09,  3.01s/it] 82%|████████▏ | 9/11 [00:30<00:06,  3.33s/it] 91%|█████████ | 10/11 [00:35<00:03,  3.79s/it]100%|██████████| 11/11 [00:37<00:00,  3.31s/it]100%|██████████| 11/11 [00:37<00:00,  3.40s/it]
SUCCESSFUL RUN: gpt2 NS
